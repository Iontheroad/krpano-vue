(function(){"use strict";var e={8894:function(e,t,o){var a=o(6369),n=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("KrpanoView")],1)},s=[],i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("NavList",{attrs:{sceneList:e.sceneList},on:{goToScene:e.goToScene},model:{value:e.currentSceneName,callback:function(t){e.currentSceneName=t},expression:"currentSceneName"}}),t("Tools",{attrs:{krpano:e.krpano}}),t("AddHotspot",{directives:[{name:"show",rawName:"v-show",value:e.isAddHotspotShow,expression:"isAddHotspotShow"}],attrs:{krpano:e.krpano,sceneList:e.sceneList,currentSceneName:e.currentSceneName,clickMouseLocation:e.clickMouseLocation},on:{addHotspot:e.addHotspot},model:{value:e.isAddHotspotShow,callback:function(t){e.isAddHotspotShow=t},expression:"isAddHotspotShow"}}),t("div",{attrs:{id:"pano"},on:{dblclick:e.dblclickScene}})],1)},r=[],p=function(){var e=this,t=e._self._c;return t("div",{staticClass:"scene-select-box"},[e.sceneList.length?t("ul",e._l(e.sceneList,(function(o){return t("li",{key:o.thumburl,class:{"hotspot-detail-scene-selected":e.currentSceneName==o.name}},[t("img",{attrs:{src:o.thumburl},on:{click:function(t){return e.clickToggleScene(o)}}}),t("div",[t("span",[e._v(e._s(o.title))])])])})),0):e._e()])},c=[],l={name:"NavList",model:{prop:"currentSceneName",event:"update:currentSceneName"},props:{krpano:{require:!0},sceneList:{require:!0},currentSceneName:{type:[Number,String],require:!0}},emits:["goToScene","update:currentSceneName"],methods:{clickToggleScene(e){this.currentSceneName!==e.name&&(this.$emit("update:currentSceneName",e.name),this.$emit("goToScene",{peak_to_sceneName:e.name},1))}}},h=l,d=o(1001),u=(0,d.Z)(h,p,c,!1,null,"6d2c4708",null),k=u.exports,m=function(){var e=this,t=e._self._c;return t("div",{staticClass:"tools-box"},[e.isAudioPlay?t("div",{staticClass:"btn audio-btn",on:{click:function(t){return e.clickAudio(!1)}}}):t("div",{staticClass:"btn audio-btn audio-stop",on:{click:function(t){return e.clickAudio(!0)}}}),t("div",{staticClass:"btn",on:{click:e.clickVR}},[e._v("VR")])])},_=[],v={name:"Tools",props:{krpano:{require:!0}},data(){return{isAudioPlay:!1}},methods:{clickAudio(e){this.isAudioPlay=e,this.krpano.call(`peak_audio(${e})`)},clickVR(){this.krpano.call("peak_enterVR")}}},g=v,f=(0,d.Z)(g,m,_,!1,null,"6422a09f",null),N=f.exports,b=function(){var e=this,t=e._self._c;return t("div",{staticClass:"add-hotspot-box"},[t("div",{staticClass:"hotspot-inp-box"},[t("div",[e._v(" 热点类型: "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectValue,expression:"selectValue"}],attrs:{name:"",id:""},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectValue=t.target.multiple?o:o[0]}}},[t("option",{attrs:{value:"2"}},[e._v("普通标记")]),t("option",{attrs:{value:"3"}},[e._v("跳转热点")])])]),3==e.selectValue?t("div",[e._v(" 要跳转的场景:"),t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectSceneId,expression:"selectSceneId"}],attrs:{name:"",id:""},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectSceneId=t.target.multiple?o:o[0]}}},e._l(e.sceneList,(function(o){return t("option",{key:o.thumburl,attrs:{disabled:e.currentSceneName==o.id},domProps:{value:o.id}},[e._v(" "+e._s(o.title)+" ")])})),0)]):e._e(),t("div",[e._v("热点tooltip:"),t("input",{directives:[{name:"model",rawName:"v-model",value:e.tooltip,expression:"tooltip"}],attrs:{type:"tooltip"},domProps:{value:e.tooltip},on:{input:function(t){t.target.composing||(e.tooltip=t.target.value)}}})]),t("div",[t("button",{on:{click:e.clickCancel}},[e._v("取消")]),t("button",{on:{click:e.clickConfirm}},[e._v("确定")])])])])},S=[],y={name:"AddHotspot",model:{prop:"isAddHotspotShow",event:"update:isAddHotspotShow"},props:{isAddHotspotShow:{type:Boolean,required:!0},krpano:{required:!0},sceneList:{required:!0},currentSceneName:{required:!0},clickMouseLocation:{required:!0}},emits:["addHotspot"],data(){return{selectValue:"2",selectSceneId:"",tooltip:"",toGoTemplate:{scale:.5,edge:"center",oy:"-20",distorted:!1,url:"static/skin/hotspot/portal.png",ath:"-155",atv:"2",peak_type:"3",peak_sceneId:"2",peak_to_scene:"scene_1",peak_to_sceneId:"1",peak_tooltip:"前往篮球场"},markerTemplate:{scale:.5,edge:"center",oy:"-20",url:"static/skin/hotspot/line.png",ath:"-83",atv:"-11",id:"8",name:"peak_hotspot_8",peak_type:"2",peak_sceneId:"2",peak_head:"https://resource.v123.cn/v/Data/upload/live/auth/656/image/5c38805344125.jpg",peak_tooltip:"不知名的神秘大楼"}}},methods:{clickCancel(){this.$emit("update:isAddHotspotShow",!1)},clickConfirm(){let{ath:e,atv:t}=this.clickMouseLocation,o=Date.now(),a=`peak_hotspot_${o}`;2==this.selectValue?console.log({...this.markerTemplate,ath:e,atv:t,id:o,name:a,peak_type:this.selectValue,peak_sceneName:this.currentSceneName,peak_tooltip:this.tooltip}):3==this.selectValue&&console.log({...this.toGoTemplate,ath:e,atv:t,id:o,name:a,peak_type:this.selectValue,peak_sceneName:this.currentSceneName,peak_tooltip:this.tooltip,peak_to_sceneName:this.selectSceneId,peak_to_scene:this.sceneList.find((e=>e.id==this.selectSceneId))}),this.$emit("addHotspot",{...this.markerTemplate,ath:e,atv:t,id:o,name:a,peak_type:this.selectValue,peak_sceneId:currentSceneName,peak_tooltip:this.tooltip}),this.$emit("update:isAddHotspotShow",!1)}}},w=y,L=(0,d.Z)(w,b,S,!1,null,"b0dbc32c",null),$=L.exports,H={name:"KrpanoView",components:{NavList:k,Tools:N,AddHotspot:$},data(){return{krpano:null,currentSceneName:"",isAddHotspotShow:!1,sceneList:[],trackMouseId:null,clickMouseLocation:{},goToHotspotList:[{scale:.5,edge:"center",oy:"-20",distorted:!1,url:"vtour/skin/hotspot/portal.png",id:"1",name:"peak_hotspot_1",ath:"-122",atv:"-0.21",peak_type:"3",peak_sceneName:"scene_10006",peak_to_sceneName:"scene_10007",peak_tooltip:"前往10007"},{id:"2",name:"peak_hotspot_2",ath:"-155",atv:"2",scale:.5,edge:"center",oy:"-20",distorted:!1,url:"vtour/skin/hotspot/portal.png",peak_type:"3",peak_sceneName:"scene_10007",peak_to_sceneName:"scene_10006",peak_tooltip:"前往10006"}],markHotspotList:[{name:"peak_hotspot_6",ath:"-136.81297139120792",atv:"-16.590751927541321",scale:.5,edge:"center",oy:"-20",ox:"5",url:"vtour/skin/hotspot/line.png",id:"6",peak_type:"2",peak_sceneName:"scene_10006",peak_head:"https://resource.v123.cn/v/Data/upload/live/auth/656/image/5c38805344125.jpg",peak_tooltip:"我曾经在这里扣篮"},{id:7,name:"peak_hotspot_7",ath:-54,atv:19,scale:.5,edge:"center",oy:"-20",url:"vtour/skin/hotspot/line.png",peak_type:"2",peak_sceneName:"scene_10006",peak_head:"https://resource.v123.cn/v/Data/upload/live/auth/656/image/5c38805344125.jpg",peak_tooltip:"挥洒汗水的地方"},{id:"8",name:"peak_hotspot_8",ath:"-73",atv:"-11",scale:.5,edge:"center",oy:"-20",url:"vtour/skin/hotspot/line.png",peak_type:"2",peak_sceneName:"scene_10007",peak_head:"https://resource.v123.cn/v/Data/upload/live/auth/656/image/5c38805344125.jpg",peak_tooltip:"不知名的神秘大楼"}]}},mounted(){window.embedpano({xml:"vtour/tour.xml",target:"pano",html5:"auto",mobilescale:1,passQueryParameters:!0,onready:e=>{this.krpano=e},onerror:e=>{console.log(e)}}),window.myGetXML=this.transmitXML,window.init=this.init,window.clickHotspot_xml=e=>{this.clickHotspot(this.goToHotspotList.find((t=>t.name==e)))}},methods:{transmitXML(e){console.log(e)},init(){this.sceneList=this.krpano.get("scene").getArray(),this.currentSceneName=this.krpano.get("xml.scene"),this.getSceneHotspot(this.currentSceneName)},preview(){window.open("static/tour.html")},krpanoControl(e){console.log(this.krpano.get("hotspot[spot1546933175342]")),this.krpano.set("layer[skin_control_bar].visible",e),this.krpano.set("layer[skin_splitter_bottom].visible",e),this.krpano.set("layer[skin_scroll_window].visible",e)},clickHotspot(e){console.log(e,123),2==e.peak_type?alert("我是普通的热点"):3==e.peak_type&&this.goToScene({hotspotName:e.name,peak_to_sceneName:e.peak_to_sceneName})},getToggleSceneAnimation(e=1){let t;switch(e){case 1:t="BLEND(1.0, easeInCubic)";break;case 2:t="ZOOMBLEND(2.0, 2.0, easeInOutSine)";break;case 3:t="COLORBLEND(2.0, 0x000000, easeOutSine)";break;case 4:t="LIGHTBLEND(1.0, 0xFFFFFF, 2.0, linear)";break;case 5:t="SLIDEBLEND(1.0, 0.0, 0.2, linear)";break;case 6:t="SLIDEBLEND(1.0, 90.0, 0.01, linear)";break;case 7:t="SLIDEBLEND(1.0, 135.0, 0.4, linear)";break;case 8:t="OPENBLEND(1.0, 0.0, 0.2, 0.0, linear)";break;case 9:t="OPENBLEND(0.7, 1.0, 0.1, 0.0, linear)";break;case 10:t="OPENBLEND(1.0, -1.0, 0.3, 0.0, linear)";break;case 11:t="OPENBLEND(1.0, -0.5, 0.3, 0.8, linear)";break;default:break}return t},goToScene(e,t=1){let o=this.getToggleSceneAnimation(t);this.krpano.call(`peak_click_to_scene(${e.peak_to_sceneName},${o},${e.hotspotName});`),setTimeout((()=>{this.currentSceneName=e.peak_to_sceneName,this.getSceneHotspot()}),1e3)},getSceneHotspot(){[...this.goToHotspotList.filter((e=>e.peak_sceneName==this.currentSceneName)),...this.markHotspotList.filter((e=>e.peak_sceneName==this.currentSceneName))].forEach((e=>{this.addHotspot(e)}))},_addHotspot(e){if(this.krpano){switch(this.krpano.call("addhotspot("+e.name+")"),this.krpano.set(`hotspot[${e.name}].ath`,e["ath"]),this.krpano.set(`hotspot[${e.name}].atv`,e["atv"]),this.krpano.set(`hotspot[${e.name}].scale`,e["scale"]),this.krpano.set(`hotspot[${e.name}].edge`,e["edge"]),this.krpano.set(`hotspot[${e.name}].oy`,e["oy"]),this.krpano.set(`hotspot[${e.name}].ox`,e["ox"]),this.krpano.set(`hotspot[${e.name}].url`,e["url"]),this.krpano.set(`hotspot[${e.name}].peak_tooltip`,e["peak_tooltip"]),this.krpano.set(`hotspot[${e.name}].text`,e["peak_tooltip"]),this.krpano.set(`hotspot[${e.name}].visible`,!0),e.peak_type){case"2":this.krpano.set(`hotspot[${e.name}].peak_head`,e["peak_head"]),this.krpano.set(`hotspot[${e.name}].onloaded`,"add_hotspot_tooltip();add_hotspot_head();add_hotspot_tooltip_vr();");break;case"3":this.krpano.set(`hotspot[${e.name}].linkedscene`,e.peak_to_sceneName),this.krpano.set(`hotspot[${e.name}].onloaded`,"do_crop_animation(100,100,15);add_hotspot_tooltip();add_hotspot_tooltip_vr()");break;default:break}this.krpano.get("device.html5")?this.krpano.set("hotspot["+e.name+"].onclick",this.clickHotspot.bind(this,e)):this.krpano.set("hotspot["+e.name+"].onclick","js( alert(calc('hotspot \"' + name + '\" clicked')) );")}},addHotspot(e){if(this.krpano){switch(this.krpano.call("addhotspot("+e.name+")"),this.krpano.set(`hotspot[${e.name}].ath`,e["ath"]),this.krpano.set(`hotspot[${e.name}].atv`,e["atv"]),this.krpano.set(`hotspot[${e.name}].scale`,e["scale"]),this.krpano.set(`hotspot[${e.name}].edge`,e["edge"]),this.krpano.set(`hotspot[${e.name}].oy`,e["oy"]),this.krpano.set(`hotspot[${e.name}].ox`,e["ox"]),this.krpano.set(`hotspot[${e.name}].url`,e["url"]),this.krpano.set(`hotspot[${e.name}].peak_tooltip`,e["peak_tooltip"]),this.krpano.set(`hotspot[${e.name}].peak_type`,e["peak_type"]),this.krpano.set(`hotspot[${e.name}].normal`,!1),this.krpano.set(`hotspot[${e.name}].visible`,!0),e.peak_type){case"2":this.krpano.set(`hotspot[${e.name}].peak_head`,e["peak_head"]),this.krpano.set(`hotspot[${e.name}].onloaded`,"add_hotspot_tooltip();add_hotspot_head();");break;case"3":let t=this.getToggleSceneAnimation(1);this.krpano.set(`hotspot[${e.name}].peak_to_sceneName`,e.peak_to_sceneName),this.krpano.set(`hotspot[${e.name}].blend`,t),this.krpano.set(`hotspot[${e.name}].onloaded`,`do_crop_animation(100,100,15);add_hotspot_tooltip_vr(${t});`);break;default:break}this.krpano.get("device.html5")?this.krpano.set("hotspot["+e.name+"].onclick",this.clickHotspot.bind(this,e)):this.krpano.set("hotspot["+e.name+"].onclick","js( alert(calc('hotspot \"' + name + '\" clicked')) );")}},getCurrentView(){if(this.krpano){let e=this.krpano.get("view.hlookat"),t=this.krpano.get("view.vlookat"),o=this.krpano.get("view.fov"),a=this.krpano.get("view.distortion");console.log({hlookat:e,vlookat:t,fov:o,distortion:a})}},dblclickScene(){this.clickMouseLocation=this.getMouseLocation(),this.isAddHotspotShow=!0},getMouseLocation(){let e=this.krpano.get("mouse.x"),t=this.krpano.get("mouse.y"),o=this.krpano.screentosphere(e,t),a=o.x,n=o.y;return{ath:a,atv:n,x:e,y:t}}}},x=H,A=(0,d.Z)(x,i,r,!1,null,"4cf78246",null),T=A.exports,O={name:"App",components:{KrpanoView:T},methods:{}},E=O,D=(0,d.Z)(E,n,s,!1,null,null,null),C=D.exports;a.ZP.config.productionTip=!1,new a.ZP({render:e=>e(C)}).$mount("#app")}},t={};function o(a){var n=t[a];if(void 0!==n)return n.exports;var s=t[a]={exports:{}};return e[a].call(s.exports,s,s.exports,o),s.exports}o.m=e,function(){var e=[];o.O=function(t,a,n,s){if(!a){var i=1/0;for(l=0;l<e.length;l++){a=e[l][0],n=e[l][1],s=e[l][2];for(var r=!0,p=0;p<a.length;p++)(!1&s||i>=s)&&Object.keys(o.O).every((function(e){return o.O[e](a[p])}))?a.splice(p--,1):(r=!1,s<i&&(i=s));if(r){e.splice(l--,1);var c=n();void 0!==c&&(t=c)}}return t}s=s||0;for(var l=e.length;l>0&&e[l-1][2]>s;l--)e[l]=e[l-1];e[l]=[a,n,s]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,a){var n,s,i=a[0],r=a[1],p=a[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(n in r)o.o(r,n)&&(o.m[n]=r[n]);if(p)var l=p(o)}for(t&&t(a);c<i.length;c++)s=i[c],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(l)},a=self["webpackChunkkrpano_vue_demo"]=self["webpackChunkkrpano_vue_demo"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=o.O(void 0,[998],(function(){return o(8894)}));a=o.O(a)})();
//# sourceMappingURL=app.c1b94dbf.js.map